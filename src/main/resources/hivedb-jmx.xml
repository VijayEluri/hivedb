<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd">
<beans>
	<!-- start a JMX Server -->
	<bean id="mbeanServer"
		class="org.springframework.jmx.support.MBeanServerFactoryBean" />

	<!--  Use an RMI registry to expose our MBeans remotely through a JSR160 JMXConnectorServer -->
	<bean id="rmiRegistry"
		class="org.springframework.remoting.rmi.RmiRegistryFactoryBean" />

	<bean id="serverConnector"
		class="org.springframework.jmx.support.ConnectorServerFactoryBean"
		depends-on="rmiRegistry">
		<property name="objectName" value="connector:name=rmi" />
		<property name="serviceUrl"
			value="service:jmx:rmi://localhost/jndi/rmi://localhost:1099/myconnector" />
	</bean>
	
	<bean name="NodeFillStatistics" class="org.hivedb.management.statistics.NodeFillStatisticsMBean">
		<constructor-arg value="100" />
		<constructor-arg value="1000" />
		<constructor-arg value="100" />
	</bean>
	
	<bean name="NodePerformanceStatistics" class="org.hivedb.management.statistics.HivePerformanceStatisticsMBean">
		<constructor-arg value="1000" />
		<constructor-arg value="100" />
	</bean>
	
	<bean name="HivePerformanceStatistics" class="org.hivedb.management.statistics.HivePerformanceStatisticsMBean">
		<constructor-arg value="1000" />
		<constructor-arg value="100" />
	</bean>
	
	<bean id="exporter"
		class="org.springframework.jmx.export.MBeanExporter"
		lazy-init="false">
		<property name="beans">
			<map>
				<entry key="Server:name=HttpAdaptorFormatted">
					<bean class="mx4j.tools.adaptor.http.HttpAdaptor">
						<property name="port" value="9000" />
						<property name="host" value="0.0.0.0" />
						<property name="processor">
							<bean
								class="mx4j.tools.adaptor.http.XSLTProcessor" />
						</property>
					</bean>
				</entry>
				<entry key="Server:name=HttpAdaptorRaw">
					<bean class="mx4j.tools.adaptor.http.HttpAdaptor">
						<property name="port" value="9001" />
						<property name="host" value="0.0.0.0" />
					</bean>
				</entry>
				<entry key="HiveDB:name=NodeFillStatistics">
					<ref bean="NodeFillStatistics" />
				</entry>
				<entry key="HiveDB:name=NodePerformanceStatistics">
					<ref bean="NodePerformanceStatistics" />
				</entry>
				<entry key="HiveDB:name=HivePerformanceStatistics">
					<ref bean="HivePerformanceStatistics" />
				</entry>
			</map>
		</property>
		<property name="listeners">
			<list>
				<!-- let the HttpAdapter be started after it is registered in the MBeanServer -->
				<bean
					class="org.hivedb.management.HttpAdaptorManager">
					<property name="mbeanServer" ref="mbeanServer" />
				</bean>
			</list>
		</property>
	</bean>
	
	

</beans>