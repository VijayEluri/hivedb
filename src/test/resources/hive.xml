<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

  <bean id="dataSourceProvider" class="org.hivedb.persistence.CachingDataSourceProvider"/>

  <bean id="hiveDataSource" class="org.hivedb.persistence.HiveBasicDataSource">
    <constructor-arg value="${hive.uri}"/>
  </bean>

  <bean id="hiveConfigFactory" class="org.hivedb.annotations.DbHiveConfigurationFactory">
    <constructor-arg ref="hiveDataSource"/>
  </bean>

  <bean id="hiveConfiguration" class="org.hivedb.configuration.HiveConfigurationImpl" factory-bean="hiveConfigFactory"
        factory-method="newInstance"></bean>

  <bean id="directoryFactory" class="org.hivedb.directory.DbDirectoryFactory">
    <constructor-arg index="0" ref="hiveDataSource"/>
    <constructor-arg index="1" ref="hiveConfiguration"/>
  </bean>

  <bean id="directoryFacadeFactory" class="org.hivedb.directory.DirectoryWrapperFactory">
    <constructor-arg>
      <bean class="org.hivedb.directory.DbDirectoryFactory">
        <constructor-arg index="0" ref="hiveDataSource"/>
        <constructor-arg index="1" ref="hiveConfiguration"/>
      </bean>
    </constructor-arg>
  </bean>

  <bean id="hiveFactory" class="org.hivedb.HiveFactory">
    <constructor-arg index="0" ref="hiveConfigFactory"/>
    <constructor-arg index="1" ref="directoryFacadeFactory"/>
    <constructor-arg index="2" ref="dataSourceProvider"/>
  </bean>

  <bean id="hive" class="org.hivedb.Hive" factory-bean="hiveFactory" factory-method="newInstance"></bean>

</beans>